apiVersion: projectcontour.io/v1
kind: HTTPProxy
metadata:
  name: {{ .Values.spec.project }}-ingress
spec:
  template:
    spec:
      nodeSelector:
        environment: {{ .Values.spec.environment }}
  ingressClassName: contour
  routes:
    - conditions:
      {{- range .Values.server }}  
      - prefix: {{ .prefix }}
        services:
          - name: {{ .name }}
            port: {{ .port }}
      {{- end}}